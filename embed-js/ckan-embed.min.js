!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(n.ck||(n.ck={})).datasets=e()}}(function(){return function e(n,t,i){function o(r,f){if(!t[r]){if(!n[r]){var a="function"==typeof require&&require;if(!f&&a)return a(r,!0);if(d)return d(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var l=t[r]={exports:{}};n[r][0].call(l.exports,function(e){var t=n[r][1][e];return o(t?t:e)},l,l.exports,e,n,t,i)}return t[r].exports}for(var d="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,n,t){(function(e){function t(e,n,t){var i=_.template('<div class="ckan-dataset"><a href="<%= ds.url %>"><h5><%= ds.title %></h5></a><p><%= ds.description %></p><b><%= ds.groupname %></b><br><small><%= ds.formats %></small></div>'),o=[],d=function(e){return e.fr||e.de||e.it||e.en},r=function(e){return _.uniq(_.map(e,function(e){return e.format})).join(" ")};for(var f in t){var a=t[f],u={url:n+"en/dataset/"+a.name,title:d(a.display_name),groupname:0==a.groups.length?"":d(a.groups[0].display_name),description:d(a.description),formats:r(a.resources),modified:a.metadata_modified};o.push(i({ds:u}))}0===o.length&&(o=["No results"]),e.html(o.join(""))}function i(e,n,i,o){var d,r,f,a,u=o||function(){};try{r=_.isString(i)?{q:i}:i,_.isUndefined(r.sort)&&(r.sort="metadata_modified desc"),_.isUndefined(r.jsonp)?a=!0:(a=r.jsonp,delete r.jsonp);var l=$(e).addClass("ckan-embed").html(""),d=new CKAN.Client(n),s="package_search";if(a){var c={url:d.endpoint+"/3/action/"+s,data:r,dataType:"jsonp",type:"POST",cache:!0};$.ajax(c).fail(function(e){if(null!=e)return void u(e)}).done(function(e){f=e.result.results,t(l,n,f),u(null,{client:d,config:r,packages:f})})}else d.action(s,r,function(e,i){return null!=e?void u(e):(f=i.result.results,t(l,n,f),void u(null,{client:d,config:r,packages:f}))})}catch(e){u(e)}}var o=("undefined"!=typeof window?window.lodash:"undefined"!=typeof e?e.lodash:null,"undefined"!=typeof window?window.jquery:"undefined"!=typeof e?e.jquery:null,"undefined"!=typeof window?window.ckan:"undefined"!=typeof e?e.ckan:null,{});i.config=o,n.exports=i}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});
