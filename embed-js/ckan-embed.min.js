!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(n.ck||(n.ck={})).datasets=e()}}(function(){return function e(n,t,o){function i(r,f){if(!t[r]){if(!n[r]){var a="function"==typeof require&&require;if(!f&&a)return a(r,!0);if(d)return d(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var s=t[r]={exports:{}};n[r][0].call(s.exports,function(e){var t=n[r][1][e];return i(t?t:e)},s,s.exports,e,n,t,o)}return t[r].exports}for(var d="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(e,n,t){(function(e){function t(e,n,t){var o=_.template('<div class="ckan-dataset"><a href="<%= ds.url %>"><h5><%= ds.title %></h5></a><p><%= ds.description %></p><b><%= ds.groupname %></b><br><small><%= ds.formats %></small></div>'),i=[],d=function(e){return e.fr||e.de||e.it||e.en},r=function(e){return _.uniq(_.map(e,function(e){return e.format})).join(" ")};for(var f in t){var a=t[f],u={url:n+"en/dataset/"+a.name,title:d(a.display_name),groupname:0==a.groups.length?"":d(a.groups[0].display_name),description:d(a.description),formats:r(a.resources),modified:a.metadata_modified};i.push(o({ds:u}))}0===i.length&&(i=["No results"]),e.html(i.join(""))}function o(e,n,o,i){var d,r,f,a,u=i||function(){};try{r=_.isString(o)?{q:o}:o,_.isUndefined(r.sort)&&(r.sort="metadata_modified desc"),_.isUndefined(r.jsonp)?a=!0:(a=r.jsonp,delete r.jsonp);var s=$(e).addClass("ckan-embed").html(""),d=new CKAN.Client(n),l="package_search";if(a){var c={url:d.endpoint+"/3/action/"+l,data:r,dataType:"jsonp",type:"POST",cache:!0};$.ajax(c).fail(function(e){if(null!=e)return void u(e)}).done(function(e){f=e.result.results,t(s,n,f)})}else d.action(l,r,function(e,o){return null!=e?void u(e):(f=o.result.results,void t(s,n,f))});u(null,{client:d,config:r,packages:f})}catch(e){u(e)}}var i=("undefined"!=typeof window?window.lodash:"undefined"!=typeof e?e.lodash:null,"undefined"!=typeof window?window.jquery:"undefined"!=typeof e?e.jquery:null,"undefined"!=typeof window?window.ckan:"undefined"!=typeof e?e.ckan:null,{});o.config=i,n.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});
